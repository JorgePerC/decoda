#!/usr/bin/python3

import rospy 

from sensor_msgs.msg import PointCloud2

import numpy as np
from sklearn.neighbors import NearestNeighbors
import cv2


import 


def lidarCallback(msg):
    # Transform the point cloud into an xyz space
    points = list(pc2.read_points(msg, field_names=("x","y","z"), skip_nans=True))
    xyzSpace = np.array(points)

    rospy.loginfo("Total points: %d", xyzSpace.shape[0])
    rospy.loginfo("It has the following structure:")
    # Check message structure:
    # https://docs.ros.org/en/melodic/api/sensor_msgs/html/msg/PointCloud2.html

    rospy.loginfo("Shape x:", msg.width, ", y:", msg.height)

    return xyzSpace


def groundSegmentator():
    rospy.init_node('GroundSegmentator')
    
    rospy.Subscriber('/lidar', PointCloud2, lidarCallback, queue_size=1)



    rospy.spin()

if __name__ == '__main__':
    groundSegmentator()